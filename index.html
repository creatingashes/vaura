<html>
<head>
<meta charset="ISO-8859-1">
<title>Vaura</title>
<script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>
</head>
<body onload="startIt()">
<div id="summary"></div><br/>

<script>
function getUrlParm(parm) {
   var res1 = new URL(window.location.href.replace("#","?"));
   if (res1.searchParams == null) {
      return null;
   } else {
      return res1.searchParams.get(parm);
   }
} 
   
function requestDashboard() {
    var URL = "https://api.spotify.com/v1/me?access_token=" + getUrlParm('access_token');
    $.get(URL, function( data ) {
      $( "body" )
          .append( "ID: " + data.id)
          .append( " Email: " + data.email);
    }, "json" );
  
    URL = "https://api.spotify.com/v1/me/playlists?access_token=" + getUrlParm('access_token');
      $.get(URL, function( data ) {
      $( "body" )
          .append( "Playlist raw: " + JSON.stringify(data));
    }, "json" );
}

function startIt() {
   if (getUrlParm('access_token') == null) {
      var authUrl = "https://accounts.spotify.com/authorize?client_id=971e22b392a7466b8e359b9622bd850b&response_type=token&redirect_uri=https://rawgit.com/creatingashes/vaura/master/index.html";
      window.location.href = authUrl;
   } else {
      requestDashboard();
   }
}
</script>
</body>
</html>
